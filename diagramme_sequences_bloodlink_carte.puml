@startuml Diagramme de Séquences - BloodLink - Consultation de la Carte

!theme plain
skinparam backgroundColor #FFFFFF
skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 60

title **Processus de Consultation de la Carte - BloodLink**

actor "Donneur" as Donor

participant "Interface Web" as UI
participant "BloodBankMapController" as MapCtrl
participant "Bank Model" as BankModel

database "Base de Données" as DB

== **Processus de Consultation de la Carte** ==

Donor -> UI: Accès à la carte des banques
UI -> MapCtrl: Demander données de la carte
MapCtrl -> BankModel: Récupérer banques actives
BankModel -> DB: Rechercher banques
DB --> BankModel: Retourner banques
BankModel --> MapCtrl: Retourner données
MapCtrl --> UI: Retourner données carte
UI -> Donor: Afficher carte

alt Recherche par proximité
    Donor -> UI: Saisir localisation
    UI -> MapCtrl: Envoyer coordonnées
    MapCtrl -> BankModel: Calculer distances
    BankModel --> MapCtrl: Retourner banques triées
    MapCtrl --> UI: Retourner résultats
    UI -> Donor: Afficher banques proches
else Filtrage par groupe sanguin
    Donor -> UI: Sélectionner groupe sanguin
    UI -> MapCtrl: Envoyer groupe sanguin
    MapCtrl -> BankModel: Filtrer par disponibilité
    BankModel --> MapCtrl: Retourner banques filtrées
    MapCtrl --> UI: Retourner résultats
    UI -> Donor: Afficher banques avec stock
end

@enduml
